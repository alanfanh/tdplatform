{% extends 'base.html' %}

{% load staticfiles %}

{% block title %}添加培训课程{% endblock  %}

{% block content %}
{% comment %} <link rel="stylesheet" href="{% static 'css/training/training.css' %}">
<link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">

<div class="all-container">
    <div class="uk-container">
        <div class="sider-bar">
            <div class="bar1">
            <!--改动-->
               <div class="menu1_icon"></div>
             <!--改动-->
                <a href="#" class="menu1 btn-default" role="button">培训</a>
            </div>
            <div class="bar2">
                <a href="#" class="menu2 btn-default" role="button">积分</a>
            </div>
        </div>
        <div class="mid">
            <img src="{% static 'images/training/mid.svg' %}" alt="" class="separate">
        </div>
        <div class="content">
            <div class="title">
                <span>添加培训</span>
            </div>
            <div class="course-name default">
                <span>培训名称：</span>
            </div>
            <div class="cname1">
                <input type="text" id="cname2" placeholder="请输入培训名称">
            </div>
            <div class="course-time default">
                <span>培训时间：</span>
            </div>
            <div class="ctime1">
                <input type="datetime-local" id="ctime2">
            </div>
            <div class="main-people default">
                <span>主讲人：</span>
            </div>
            <div class="mpeople1">
                <select id="mpeople2" placeholder="请选择主讲人"></select>
            </div>
            <div class="course-member default">
                <span>参与成员：</span>
            </div>
            <div class="cmember1">
                <select id="cmember2"></select>
            </div>
            <div class="course-address default">
                <span>培训地址：</span>
            </div>
            <div class="address1">
                <input type="text" id="address2" placeholder="请输入培训地址">
            </div>
            <div class="course-range default">
                <span>培训范围：</span>
            </div>
            <div class="range1">
                <select id="range2"></select>
            </div>
            <div class="course-content default">
                <span>内容概括：</span>
            </div>
            <div class="content1">
                <textarea cols="55" rows="10" id="content2" οnfοcus="document.getElementById('note').style.display='none'" οnblur="if(value=='')document.getElementById('note').style.display='block'" ></textarea>
                <div id="note">
                    <font>请简单概括一下培训记录的大致内容</font>
                </div>
            </div>
            <div class="course-file default">
                <span>上传附件：</span>
            </div>
            <div class="file1 default">
                <input type="file" id="file2">
                <span class="file-tip">支持扩展名：.ppt .doc .xls .xlsx .rar .zip .pdf .md。</span>
            </div>
            <div class="course-button">
                <button id="course-save">提交</button>
                <button id="course-cancle">取消</button>
            </div>
        </div>
    </div>
</div> {% endcomment %}


<link rel="stylesheet" href="{% static 'css/account/admin_group.css' %} ">
<link rel="stylesheet" href="{% static 'css/account/manager.css' %} ">
<link rel="stylesheet" href="{% static 'css/training/train.css' %}">

<div class="base">
    <div class="baseplate">
        <div class="menuinfo">
            <div class="gmenu_cp1">
                <span class="left_bd"></span>
                <a href="{% url 'training:course_list' %}"><span class="chpract">培训课程</span></a>
            </div>
            <div class="gmenu_cp2">
                <a href="{% url 'training:point_list' %}"><span class="m_mdata">积分展示</span></a>
            </div>
        </div>
        <div class="info_base">
            <div class="Cp_title">
                <span class="Cust_Com">添加培训课程</span>
            </div>
            <form action="." method="post" enctype="multipart/form-data">{% csrf_token %}
                <div class="gnbd">
                    <span class="taname">培训名称：</span>
                    <input type="text" class="course-name" name="cname" placeholder="请输入培训名称">
                </div>
                <div class="tabd2">
                    <span class="taname">培训时间：</span>
                    <div style="width:400px;height:32px;top:6px;left:115px;position:relative">
                        <input type="text" class="layui-input" name="course_time" id="course_time" style="height:32px">
                    </div>
                    {% comment %} <input type="text" name="course_time" style="color: rgb(153, 153, 153);" class="tatm"> {% endcomment %}
                </div>
                <div class="tabd3">
                    <span class="taauth">主讲人：</span>
                    <select class="group-user" name="" id="groups-user" onchange="change_teacher();">
                        {% for group in groups %}
                        <option value="{{group.id}}">{{group.name}}</option>
                        {% endfor %}
                    </select>
                    <select class="taauthpick" id="id_teacher" name="teacher">
                        
                    </select>
                </div>
                <div class="tabd4">
                    <span class="taname">参与成员：</span>
                    {% comment %} <select class="tampick">
                        <option value="0"></option>
                    </select> {% endcomment %}
                    <div class="tree-select">
                        <input type="hidden" name="student-joined" value="">
                        <div id="joined"></div>
                        {% comment %} <textarea id="demo" class="tampick" style="overflow:hidden;cursor: pointer" checks="1,11,2,23" type="text" readonly></textarea> {% endcomment %}
                    </div>
                </div>
                <div class="tabd5">
                    <span class="taname">培训地址：</span>
                    <input type="text" class="ittaname" name="address" placeholder="请输入培训地址">
                </div>
                <div class="tabd6">
                    <span class="taname">培训范围：</span>
                    <select class="tarang" name="range">
                        <option value="测试部">测试部</option>
                        <option value="自动化开发组">自动化开发组</option>
                        <option value="接入测试组">接入测试组</option>
                        <option value="家用测试组">家用测试组</option>
                        <option value="商用测试组">商用测试组</option>
                        <option value="便携测试组">便携测试组</option>
                        <option value="资料开发组">资料开发组</option>
                        <option value="OEM测试组">OEM测试组</option>
                    </select>
                </div>
                <div class="tabd7">
                    <span class="tacontsum">内容概括：</span>
                    <textarea class="tasumtext" cols="30" rows="10" name="cdescription" placeholder="请简单概括一下培训记录的大致内容"></textarea>
                </div>
                <div class="tabd8">
                    <span class="taname">上传附件：</span>
                    <div class="taupextra">
                        {{form.file_name}}
                    </div>
                    {% comment %} <button class="taupextra">
                        <img src="images/4/uparrow.png" class="tauparr">
                        <span class="ldtext">点击上传</span>
                    </button> {% endcomment %}
                    <span class="tafileformt">支持扩展名：.ppt .doc .xls .xlsx .rar .zip .pdf .md。</span>
                    <input type="submit" id="tahandin" value="提交">
                    <button id="tarevoke"  onclick="window.history.back()">取消</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
layui.use('transfer', function(){
    var transfer = layui.transfer;
    let $ = layui.$;
    $.get('/training/get-userinfo/',{}, 
        function(data,status) {
            //console.log(data['data']);
            //渲染
            transfer.render({
                elem: '#joined'  //绑定元素
                ,data: data['data']
                ,id: 'demo1' //定义索引
                ,width:162
                ,title:['未参加成员','参加成员']
                ,showSearch: true
                ,parseData: function (res) {
                    return {
                        "value": res.id
                        ,"title": res.realname
                        ,"disabled": res.disabled
                        ,"checked": res.checked
                    }
                }
                ,onchange: function (data, index) {
                    var transfer = layui.transfer;
                    var data = transfer.getData('demo1');
                    var ids = [];
                    for(let i = 0, len=data.length; i<len; i++) {
                        let value = data[i].value
                        ids.push(value)
                    };
                    $("input[name='student-joined']").attr("value",ids.join(','));
                }
            });
            
        }, "json");
});
// 日期时间控件
layui.use('laydate', function(){
  var laydate = layui.laydate;
  
  //执行一个laydate实例
  laydate.render({
    elem: '#course_time' //指定元素
    ,type: 'datetime'
    ,format: 'yyyy/MM/dd HH:mm:ss'
  });

});

</script>

{% endblock  %}